!function(t,n){"function"==typeof define&&define.amd?define([],n):"undefined"!=typeof module?module.exports=n:t.riotux=n()}(this,function(){"use strict";function t(){this.store={dispatch:function(t){var n=Array.prototype.slice.call(arguments,1),i=[o.state],s=i.concat(n);return e&&(i=[o.state[e]]),new Promise(function(n,e){n(o.mutations[t].apply(null,s))}).then(function(t){o.update()})}},this.actions={}}var n,e,i=function(t){for(var n,e=(o.state[t[t.length-2]],o.state[t[t.length-2]][t[t.length-1]],0);e<t.length;e++)"object"!==o.state[t[t.length-2]][t[t.length-1]]&&(n=[t[t.length-2]]);return n.toString()},s=function(t){return"function"==typeof t.forceUpdate?void t.forceUpdate():void t.update()},o={tags:[],subscribe:function(t,n){o.tags.push({component:t,states:n})},unsubscribe:function(t){o.tags.forEach(function(n,e){n.tag===t&&o.tags.splice(e,1)})},emit:function(t){t()},update:function(){o.emit(function(){o.tags.forEach(function(t,e,i){-1!==t.states.indexOf(n)&&s(t.component)})})}};return t.prototype={subscribe:function(t){var n=Array.prototype.slice.call(arguments,1);o.subscribe(t,n)},unsubscribe:function(t){o.unsubscribe(t)},Store:function(t){return o=Object.assign(o,t),this.store},Actions:function(t){return this.actions=t,this.actions},action:function(){if(n=arguments[0],-1!==n.indexOf(":")){var t=n.split(":");if(e=i(t),n=[t[t.length-1]],void 0!==o.state[e][t[t.length-1]]){var s=Array.prototype.slice.call(arguments,2);this.actions[arguments[1]].apply(null,s)}}else if(void 0!==o.state[n]){var s=Array.prototype.slice.call(arguments,2);this.actions[arguments[1]].apply(null,s)}else{var s=Array.prototype.slice.call(arguments,1);this.actions[arguments[0]].apply(null,s)}},getter:function(t){return o.state[t]}},new t});